<app-loading [isLoading]="isLoading"></app-loading>

<section>
    <div class="banner">
        <h2>INFORMES</h2>
    </div>
</section>

<section class="lista-informes">
    <h3>Informes disponibles</h3>

    <div class="informes-container">
        <div class="informe" (click)="mostrarInforme(0)">
            <img src="assets/img/informe.png" />
            <h4>Ingresos Al Sistema</h4>
        </div>

        <div class="informe" (click)="mostrarInforme(1)">
            <img src="assets/img/informe.png" />
            <h4>Turnos por Especialidad</h4>
        </div>

        <div class="informe" (click)="mostrarInforme(2)">
            <img src="assets/img/informe.png" />
            <h4>Turnos por DÃ­a</h4>
        </div>

        <div class="informe" (click)="mostrarInforme(3)">
            <img src="assets/img/informe.png" />
            <h4>Turnos solicitados por mÃ©dico</h4>
        </div>

        <div class="informe" (click)="mostrarInforme(4)">
            <img src="assets/img/informe.png" />
            <h4>Turnos finalizados por mÃ©dico</h4>
        </div>
    </div>
</section>

<section *ngIf="informeAMostrar !== null" class="graficos-estadisticas">
    
    <div class="grafico">
        <div *ngIf="informeAMostrar === Informe.Ingresos && chartData" [@slideIn]>
            <canvas id="ingresosChart" baseChart [datasets]="chartData.data.datasets" [labels]="chartData.data.labels"
            [options]="chartData.options">
            </canvas>
        </div>

        <div *ngIf="informeAMostrar === Informe.TurnosPorEspecialidad && chartData" [@slideIn]>
            <canvas id="especialidadChart" baseChart [data]="chartData.data" [options]="chartData.options" [type]="chartData.type">
            </canvas>
        </div>

        <div *ngIf="informeAMostrar === Informe.TurnosPorDia && chartData" [@slideIn]>
            <canvas id="diaChart" baseChart [datasets]="chartData.data.datasets" [labels]="chartData.data.labels"
                [options]="chartData.options">
            </canvas>
        </div>

        <div *ngIf="informeAMostrar === Informe.TurnosSolicitadosPorMedicoEnTiempo && !chartData">
            <h4>Seleccionar un periodo de tiempo</h4>
            <div class="datepicker-container">
                <input type="date" [(ngModel)]="startDate" />
                <input type="date" [(ngModel)]="endDate" />
                <button [disabled]="!startDate || !endDate || endDate < startDate"
                    (click)="obtenerTurnosSolicitadosPorMedico()">Mostrar</button>
            </div>
        </div>

        <div *ngIf="informeAMostrar === Informe.TurnosSolicitadosPorMedicoEnTiempo && chartData" [@slideIn]>
            <canvas id="turnosSolicitadosChart" baseChart [datasets]="chartData.data.datasets" [labels]="chartData.data.labels"
                [options]="chartData.options">
            </canvas>
        </div>

        <div *ngIf="informeAMostrar === Informe.TurnosFinalizadosPorMedicoEnTiempo && !chartData">
            <h4>Seleccionar un periodo de tiempo</h4>
            <div class="datepicker-container">
                <input type="date" [(ngModel)]="startDate" />
                <input type="date" [(ngModel)]="endDate" />
                <button [disabled]="!startDate || !endDate || endDate < startDate"
                    (click)="obtenerTurnosFinalizadosPorMedico()">Mostrar</button>
            </div>
        </div>

        <div *ngIf="informeAMostrar === Informe.TurnosFinalizadosPorMedicoEnTiempo && chartData" [@slideIn]>
            <canvas id="turnosFinalizadosChart" baseChart [datasets]="chartData.data.datasets" [labels]="chartData.data.labels"
                [options]="chartData.options">
            </canvas>
        </div>
    </div>

    <div class="estadisticas">
        <div *ngIf="informeAMostrar === Informe.Ingresos && chartData" [@slideIn]>
            <h4>EstadÃ­sticas de Ingresos</h4>
            <p>ðŸ’Ž<strong>DÃ­a con mÃ¡s ingresos:</strong> {{ ingresosStats.maxIngresosDay[0] }} ({{ ingresosStats.maxIngresosDay[1] }} ingresos)</p>
            <p>ðŸ’Ž<strong>DÃ­a con menos ingresos:</strong> {{ ingresosStats.minIngresosDay[0] }} ({{ ingresosStats.minIngresosDay[1] }} ingresos)</p>
            <p>ðŸ’Ž<strong>Usuario con mÃ¡s ingresos:</strong> {{ ingresosStats.maxIngresosUser[0] }} ({{ ingresosStats.maxIngresosUser[1] }} ingresos)</p>
            <p>ðŸ’Ž<strong>Usuario con menos ingresos:</strong> {{ ingresosStats.minIngresosUser[0] }} ({{ ingresosStats.minIngresosUser[1] }} ingresos)</p>
            <button (click)="generatePDF()">Generar PDF</button>
        </div>

        <div *ngIf="informeAMostrar === Informe.TurnosPorEspecialidad && chartData" [@slideIn]>
            <h4>EstadÃ­sticas de Turnos por Especialidad</h4>
            <p>ðŸ’Ž<strong>Especialidad con mÃ¡s turnos:</strong> {{ turnosPorEspecialidadStats.maxTurnosEspecialidad[0] }} ({{ turnosPorEspecialidadStats.maxTurnosEspecialidad[1] }} turnos)</p>
            <p>ðŸ’Ž<strong>Especialidad con menos turnos:</strong> {{ turnosPorEspecialidadStats.minTurnosEspecialidad[0] }} ({{ turnosPorEspecialidadStats.minTurnosEspecialidad[1] }} turnos)</p>
            <button (click)="generatePDF()">Generar PDF</button>
        </div>

        <div *ngIf="informeAMostrar === Informe.TurnosPorDia && chartData" [@slideIn]>
            <h4>EstadÃ­sticas de Turnos por DÃ­a</h4>
            <p>ðŸ’Ž<strong>DÃ­a con mÃ¡s turnos:</strong> {{ turnosPorDiaStats.maxTurnosDia[0] }} ({{ turnosPorDiaStats.maxTurnosDia[1] }} turnos)</p>
            <p>ðŸ’Ž<strong>DÃ­a con menos turnos:</strong> {{ turnosPorDiaStats.minTurnosDia[0] }} ({{ turnosPorDiaStats.minTurnosDia[1] }} turnos)</p>
            <p>ðŸ’Ž<strong>Promedio de turnos por dÃ­a:</strong> {{ turnosPorDiaStats.avgTurnosDia }}</p>
            <button (click)="generatePDF()">Generar PDF</button>
        </div>

        <div *ngIf="informeAMostrar === Informe.TurnosSolicitadosPorMedicoEnTiempo && chartData" [@slideIn]>
            <h4>EstadÃ­sticas de Turnos Solicitados por MÃ©dico</h4>
            <p>ðŸ’Ž<strong>MÃ©dico con mÃ¡s turnos solicitados:</strong> {{ turnosSolicitadosPorMedicoStats.maxTurnosMedico[0] }} ({{ turnosSolicitadosPorMedicoStats.maxTurnosMedico[1] }} turnos)</p>
            <p>ðŸ’Ž<strong>MÃ©dico con menos turnos solicitados:</strong> {{ turnosSolicitadosPorMedicoStats.minTurnosMedico[0] }} ({{ turnosSolicitadosPorMedicoStats.minTurnosMedico[1] }} turnos)</p>
            <button (click)="generatePDF()">Generar PDF</button>
        </div>

        <div *ngIf="informeAMostrar === Informe.TurnosFinalizadosPorMedicoEnTiempo && chartData" [@slideIn]>
            <h4>EstadÃ­sticas de Turnos Finalizados por MÃ©dico</h4>
            <p>ðŸ’Ž<strong>MÃ©dico con mÃ¡s turnos finalizados:</strong> {{ turnosFinalizadosPorMedicoStats.maxTurnosMedico[0] }} ({{ turnosFinalizadosPorMedicoStats.maxTurnosMedico[1] }} turnos)</p>
            <p>ðŸ’Ž<strong>MÃ©dico con menos turnos finalizados:</strong> {{ turnosFinalizadosPorMedicoStats.minTurnosMedico[0] }} ({{ turnosFinalizadosPorMedicoStats.minTurnosMedico[1] }} turnos)</p>
            <button (click)="generatePDF()">Generar PDF</button>
        </div>
    </div>
</section>

<section *ngIf="informeAMostrar === null" class="mensaje">
    <p>Seleccionar un informe</p>
</section>